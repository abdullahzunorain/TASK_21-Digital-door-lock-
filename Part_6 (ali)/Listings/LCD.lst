C51 COMPILER V9.60.7.0   LCD                                                               09/19/2024 12:25:00 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Objects\LCD.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE LCD.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\LCD.l
                    -st) TABS(2) OBJECT(.\Objects\LCD.obj)

line level    source

   1          #include "LCD.h"
   2          #include <stdio.h>
   3          
   4          unsigned int i = 0;
   5          unsigned int j = 0;
   6          unsigned int digit = 0;
   7          unsigned int index = 0;
   8          
   9          void ms_delay(unsigned int x)
  10          {
  11   1        unsigned int i,j;
  12   1        for(i = 0; i<x; i++)
  13   1          for(j = 0; j<112; j++);
  14   1      }
  15          
  16          void LCD_write_cmd(unsigned char cmd)
  17          {
  18   1        LCD_data = cmd;
  19   1        
  20   1        LCD_RS = 0;
  21   1        LCD_WR = 0;
  22   1        LCD_EN = 1;
  23   1        ms_delay(10);
  24   1        LCD_EN = 0;
  25   1        ms_delay(10);
  26   1      }
  27          void LCD_write_data(unsigned char d)
  28          {
  29   1        LCD_data = d;
  30   1        LCD_RS = 1;
  31   1        LCD_WR = 0;
  32   1        
  33   1        LCD_EN = 1;
  34   1        ms_delay(10);
  35   1        LCD_EN = 0;
  36   1        ms_delay(10);
  37   1      }
  38          void LCD_clear()
  39          {
  40   1        LCD_write_cmd(0x01);    // Clear display and set DDRAM address 0x00
  41   1        ms_delay(10);
  42   1      }
  43          
  44          void LCD_init(void)
  45          {
  46   1        LCD_write_cmd(0x38);      // 8-bit, 2-line display, 5x8 font
  47   1        ms_delay(10);
  48   1        
  49   1        LCD_clear();
  50   1        ms_delay(10);
  51   1        
  52   1        LCD_write_cmd(0x06);
  53   1        ms_delay(10);
  54   1        
C51 COMPILER V9.60.7.0   LCD                                                               09/19/2024 12:25:00 PAGE 2   

  55   1        LCD_write_cmd(0x0C);      // Display on, cursor off, blink off
  56   1        ms_delay(10);
  57   1      }
  58          
  59          void set_cursor(unsigned int row, unsigned int col)
  60          {
  61   1        if(row == 1)
  62   1        {
  63   2          LCD_write_cmd(0x80 | col-1);
  64   2          ms_delay(10);
  65   2        }
  66   1        else if(row == 2)
  67   1        {
  68   2          LCD_write_cmd(0xC0 | ((col-1)+0x40));
  69   2          ms_delay(10);
  70   2        }
  71   1      }
  72          void disp_string(unsigned int row, unsigned int col,char name[])
  73          {
  74   1          int i = 0;
  75   1        
  76   1          set_cursor(row, col);
  77   1        
  78   1          while (name[i] != '\0')
  79   1          {
  80   2              LCD_write_data(name[i]);
  81   2              ms_delay(10);
  82   2              i++;
  83   2          }
  84   1      }
  85          
  86          void LCD_disp_numb(unsigned int row, unsigned int col,unsigned long int Number, unsigned char Length)
  87          {
  88   1          unsigned long int divisor = 1;
  89   1          unsigned char q;
  90   1          
  91   1          set_cursor(row, col);
  92   1        
  93   1          for (i = 1; i < Length; i++) {
  94   2              divisor *= 10;
  95   2          }
  96   1      
  97   1          for (q = 0; q < Length; q++) {
  98   2              digit = (Number / divisor) % 10;
  99   2              LCD_write_data(digit + '0');
 100   2              divisor /= 10;
 101   2          }
 102   1      }
 103          
 104          void LCD_disp_PSW(unsigned int row, unsigned int col,unsigned long int Number)
 105          {
 106   1          unsigned long int Length = 0;
 107   1          unsigned long int temp = Number;
 108   1          unsigned long int divisor = 1;
 109   1          unsigned char q;
 110   1          unsigned char digit;
 111   1      
 112   1          // Find the length of the number
 113   1          set_cursor(row,col);
 114   1          if (Number == 0)
 115   1              Length = 1;
 116   1          else
C51 COMPILER V9.60.7.0   LCD                                                               09/19/2024 12:25:00 PAGE 3   

 117   1          {
 118   2              while (temp != 0)
 119   2              {
 120   3                  Length += 1;
 121   3                  temp /= 10;  // Integer division to remove the last digit
 122   3              }
 123   2          }
 124   1      
 125   1          // Calculate the divisor to extract individual digits
 126   1          for ( i = 1; i < Length; i++)
 127   1          {
 128   2              divisor *= 10;
 129   2          }
 130   1      
 131   1          // Display each digit on the LCD
 132   1          for (q = 0; q < Length; q++)
 133   1          {
 134   2              digit = (Number / divisor) % 10;
 135   2              LCD_write_data(digit + '0');
 136   2              divisor /= 10;
 137   2          }
 138   1      }
 139          
 140          void LCD_default_psw_display(unsigned int row, unsigned int col,unsigned long int Number, unsigned char Le
             -ngth)
 141          {
 142   1          unsigned long int divisor = 1;
 143   1          unsigned char q;
 144   1          unsigned int dig = 0;
 145   1          unsigned int v;
 146   1          set_cursor(row,col);
 147   1          for (v = 1; v < Length; v++) {
 148   2              divisor *= 10;
 149   2          }
 150   1      
 151   1          for (q = 0; q < Length; q++) {
 152   2              dig = (Number / divisor) % 10;
 153   2              LCD_write_data(dig + '0');
 154   2              divisor /= 10;
 155   2          }
 156   1      }
 157          
 158          void serial_display_psw(unsigned long int Number, unsigned char Length)
 159          {
 160   1          unsigned long int divisor = 1;
 161   1          unsigned char q;
 162   1          unsigned int dig = 0;
 163   1          unsigned int v;
 164   1      
 165   1          for (v = 1; v < Length; v++) {
 166   2              divisor *= 10;
 167   2          }
 168   1      
 169   1          for (q = 0; q < Length; q++) {
 170   2              dig = (Number / divisor) % 10;
 171   2              SBUF = dig + '0';
 172   2              divisor /= 10;
 173   2              ms_delay(100);
 174   2          }
 175   1      }


C51 COMPILER V9.60.7.0   LCD                                                               09/19/2024 12:25:00 PAGE 4   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    927    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8      71
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
